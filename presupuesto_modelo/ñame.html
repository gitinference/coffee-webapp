<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Presupuesto modelo: Ñame habanero en la zona de altura húmeda en PR (1 cuerda)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    input, select { width: 95%; padding: 4px; }

    td:first-child,
    th:first-child{
      text-align: left;
    }
  </style>
</head>
<body>
  <h1>Presupuesto modelo: Ñame habanero en la zona de altura húmeda en PR (1 cuerda)<sup style="font-size: 0.1em;">K11</sup></h1>

  <table>
    <thead>
      <tr><th colspan="6">PROYECCIÓN POR CUERDA</th></tr>
    </thead>
    <tbody id="proyeccion-tbody">
      <!-- This will be filled with JS -->
    </tbody>
  </table>

  <table>
    <thead>
    
      <tr>
        <th>Trabajos</th>
        <th>Unidad</th>
        <th>Cantidad</th>
        <th>$/Unidad</th>
        <th>Valor $</th>
        <th>Mi Finca</th>
      </tr>

    </thead>
    <tbody id="tabla">
      <!-- Filas generadas por JS -->
    </tbody>

    <tfoot>
      <tr>
        <td colspan="10" style="padding: 20px; background-color: #fff; line-height: 1.6;">

          <h2 style="color: #000000; font-size: 1.1em">Supuestos</h2>			
          <ol style="padding-left: 20px;">
            <li>10% del total de mano de obra y maquinaria</li>
            <li>Las obligaciones patronales incluyen pagos al Internal Revenue Service (Seguro Social), Fondo del Seguro del Estado (Seguro Obrero), Departamento del Trabajo (Seguro por Desempleo) y Seguro Social Choferil (Seguro Choferil).</li>
            <li>El uso de capital circulante es el costo del dinero en efectivo que se usa en la empresa.  Total de gastos en efectivo por la tasa de interés prevaleciente en el mercado (9%).</li>

								
          </ol>

          <span style="font-weight: bold;font-size: 1.1em;">Preparado por:</span><br><br>
          <strong>  Mildred Cortes, PhD</strong><br>
          Catedrática de Extensión Agrícola en Economía Agrícola<br>
          <strong>Manuel Diaz, PhD</strong><br>
          Especialista en Farináceos<br><br>
      

          <span style="font-weight: bold;font-size: 1.1em;">Versión Electrónica:</span><br><br> 
          <strong> Alexandra Gregory Crespo, PhD</strong><br>
          Catedrática del Servicio de Extensión Agrícola en Economía Agrícola<br>
          <strong>Joe Kirk R. Lucarne</strong> <br>
          Estudiante Graduado Servicio de Extensión Agrícola<br>
          <strong>Yaira A. Avilés Ortiz</strong>
          <br>
          <br>

    
          <span style="font-weight: bold; font-size:1.1em;">Versión Web:</span><br><br>
         <strong> Julio C. Hernández Correa</strong><br>
          Catedrático del Servicio de Extensión Agrícola en Economía Agrícola<br><br><br>
    
          <span style="font-weight: bold;">Fecha de revisión:</span><br>
          Junio 2025<br><br>
    
          <div style="margin-top: 20px; padding: 12px; border-left: 5px solid #d9534f; background-color: #fdf2f2;">
            <strong>AVISO:</strong> Los Presupuestos Modelos presentan la información de los ingresos y gastos bajo condiciones normales y características particulares de una finca. La Universidad de Puerto Rico no asume responsabilidad por los resultados si los ingresos y gastos de una empresa en particular difieren de dicha publicación. El usuario de estos modelos releva a la Universidad de Puerto Rico de toda responsabilidad, reclamación, pérdida, daño o costo relacionado o surgido por el uso de estos modelos.
          </div>
    
          <div style="margin-top: 20px; font-size: 0.85em; text-align: center; color: #999;">
            This material is based upon work supported by USDA/OPPE under Award Number: AO212501x443G010
          </div>
        </td>
      </tr>
    </tfoot>

    
  </table>
<!----------------------------------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------------------------------->
  <script>

    const tabla = document.getElementById("tabla");

    const actividades = {
      "Preparación de Terreno": 7.25,
      "Poda": 8.50,
      "Cosecha": 6.75
    };

    const header1 = document.createElement("tr");
      header1.innerHTML = `<th colspan="6" style="text-align: center; background-color: #cccccc;">GASTOS EN MANO DE OBRA</th>`;
      tabla.appendChild(header1);

    const mano_de_obra_1 = [
    "Preparación del suelo", 
    "Encalado", 
    "Preparación de bancos",
    "Preparación de semilla",
    "Distribución y siembra de semilla ",
    "Estaqueado",
    "Abonamiento",
    "Cultivo y combate de plagas",
    "Cosecho y manejo de productos",
  ];

  

    mano_de_obra_1.forEach((trabajo, index) => {
      const fila = document.createElement("tr");
      
      fila.innerHTML = `
      <td>${trabajo}</td>
      <td>Horas</td>
      <td><input type="number" min="0" step="1" id="cantidad-${index}"  oninput="calcularValor_t1(${index})"></td>
      <td><input type="number" min="0" step="0.01" id="costo-${index}"  oninput="calcularValor_t1(${index})"></td>
      <td id="valor-${index}">$0.00</td>
      <td id="mi-finca-t1-${index}">$-</td>
    `;

    tabla.appendChild(fila);
  });

    

    // const filaTotal_t1 = document.createElement("tr");
    // filaTotal_t1.innerHTML = `
    //     <th colspan="4">REMOVER!!</th>
    //     <th id="total-valorest1">$0.00</th>
    //     <th id=total-finca-t1>$.00</th>

        
    //   `;
    //   tabla.appendChild(filaTotal_t1);


    const filaTotalMaq_t1 = document.createElement("tr");
    filaTotalMaq_t1.innerHTML = `
        <th colspan="4">TOTAL DE GASTOS DE MANO DE OBRA Y MAQUINARIA</th>
        <th id="total-valoresMaqt1">$0.00</th>
        <th id=total-finca-Maqt1>$0.00</th>

        
      `;
      tabla.appendChild(filaTotalMaq_t1);


    function calcularValor_t1(index){
      const costo = parseFloat(document.getElementById(`costo-${index}`).value) || 0;
      const cantidad= parseFloat(document.getElementById(`cantidad-${index}`).value) || 0;
      const valorCalculado=costo * cantidad;
      document.getElementById(`valor-${index}`).textContent = "$" + valorCalculado.toFixed(2);

      const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
    const miFincaValor = valorCalculado * numCuerdas;
    const miFincaCell = document.getElementById(`mi-finca-t1-${index}`);
    if (miFincaCell) {
      miFincaCell.textContent = "$" + miFincaValor.toFixed(2);
    }

    calcularTotal_año_t1(); 
    calcularTotaldeTodo();
  
  
    }


    function calcularTotal_año_t1() {
    let total_valores_t1 = 0;
    let total_con_maquinaria_t1=0;
    let totalFinca_valores_t1 = 0;
    let totalFinca_con_maquinaria_t1 = 0;

  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;


    for (let i = 0; i < mano_de_obra_1.length; i++) {
    const texto = document.getElementById(`valor-${i}`).textContent; 
    const valor = parseFloat(texto.replace("$", "")) || 0;
    const finca = valor * numCuerdas;
    if (i<2){
      total_con_maquinaria_t1+=valor;
      totalFinca_con_maquinaria_t1 += finca;
    }
    else{
    total_valores_t1 += valor;
    totalFinca_valores_t1 += finca;
    }
  }
  // document.getElementById("total-valorest1").textContent = "$" + total_valores_t1.toFixed(2);
  // document.getElementById("total-finca-t1").textContent = "$" + totalFinca_valores_t1.toFixed(2);

  const totalGeneral = total_valores_t1 + total_con_maquinaria_t1;
  const totalFincaGeneral = totalFinca_valores_t1 + totalFinca_con_maquinaria_t1;

  document.getElementById("total-valoresMaqt1").textContent = "$" + totalGeneral.toFixed(2);
  document.getElementById("total-finca-Maqt1").textContent = "$" + totalFincaGeneral.toFixed(2);

  updateOtrosGastos();
}

function actualizarValoresMiFinca_t1() {
  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;

  for (let i = 0; i < mano_de_obra_1.length; i++) {
    const cantidad = parseFloat(document.getElementById(`cantidad-${i}`)?.value) || 0;
    const costo = parseFloat(document.getElementById(`costo-${i}`)?.value) || 0;
    const valor = cantidad * costo;
    const miFincaCell = document.getElementById(`mi-finca-t1-${i}`);
    if (miFincaCell) {
      miFincaCell.textContent = "$" + (valor * numCuerdas).toFixed(2);
    }
  }

  calcularTotal_año_t1(); 
}




    const filaVacía_1 = document.createElement("tr");
    filaVacía_1.innerHTML = `<td colspan=6 style="height: 20px; background-color: transparent;"></td>`;
      tabla.appendChild(filaVacía_1);

//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------

    const materiales_t2 = [
    ["Semilla","Quintal"],
    ["Carbonato calizo","Tonelada"],
    ["Estacas","C/U"],
    ["Abono (12-5-15-3%EM)", "Quintal"],
    ["Fungicida","Onza"],
    ["Herbicida (preemergente)", "Pinta"],
    ["Herbicida (postemergente)","Galón"],
    ["Nematicidas/insecticidas",'Litro'],
    ["Cajas","C/U"]

  ]

      const header_t2 = document.createElement("tr");
       header_t2.innerHTML = `<th colspan="6" style="text-align: center; background-color: #cccccc;">GASTOS EN MATERIALES</th>`;
       tabla.appendChild(header_t2);

       materiales_t2.forEach((trabajo, index) => {
      const fila = document.createElement("tr");
      
      fila.innerHTML = `
      <td>${trabajo[0]}</td>
      <td>${trabajo[1]}</td>





      <td><input type="number" min="0" step="1" id="t2-cantidad-${index}" oninput="calcularValor_t2(${index})"></td>
      <td><input type="number" min="0" step="1" id="t2-costo-${index}" oninput=calcularValor_t2(${index})></td>
      <td id="t2-valor-${index}">$0.00</td>
      <td id="mi-finca-t2-${index}">-</td>
     
    `;

    tabla.appendChild(fila);
  });
 


  const filaTotal_t2 = document.createElement("tr");
    filaTotal_t2.innerHTML = `
        <th colspan="4">SUBTOTAL</th>
        <th id="total-valores-t2">$0.00</th>
        <th id=total-finca-t2>$.00</th>

        
      `;
      tabla.appendChild(filaTotal_t2);

    function calcularValor_t2(index){
    const costo = parseFloat(document.getElementById(`t2-costo-${index}`).value) || 0;
      const cantidad= parseFloat(document.getElementById(`t2-cantidad-${index}`).value) || 0;
      const valorCalculado=costo * cantidad;
      document.getElementById(`t2-valor-${index}`).textContent = "$" + valorCalculado.toFixed(2);

    const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
    const miFincaValor = valorCalculado * numCuerdas;
    const miFincaCell = document.getElementById(`mi-finca-t2-${index}`);
    if (miFincaCell) {
      miFincaCell.textContent = "$" + miFincaValor.toFixed(2);
    }
    calcularTotal_año_t2();
    }

    function calcularMiFinca_t2(index){
        const valor=parseFloat(document.getElementById(`t2-valor-${index}`).textContent) || 0;
    }

    function calcularTotal_año_t2() {
      let total_valores_t2 = 0;
      let total_finca_t2 = 0;
    const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
    for (let i = 0; i < materiales_t2.length; i++) {
      const texto = document.getElementById(`t2-valor-${i}`).textContent || "$0.00";
    const valor = parseFloat(texto.replace("$", "")) || 0;  
      total_valores_t2 += valor;

      const miFincaValor = valor * numCuerdas;
      total_finca_t2 += miFincaValor;
    const celda = document.getElementById(`mi-finca-t2-${i}`);
    if (celda) {
      celda.textContent = "$" + miFincaValor.toFixed(2);
  }


}
document.getElementById("total-valores-t2").textContent = "$" + total_valores_t2.toFixed(2);
  document.getElementById("total-finca-t2").textContent = "$" + total_finca_t2.toFixed(2);
  calcularTotaldeTodo();
}
 

    const filaVacía_2 = document.createElement("tr");
      filaVacía_2.innerHTML = `<td colspan="6" style="height: 20px; background-color: transparent;"></td>`;
      tabla.appendChild(filaVacía_2);

//-----------------------------------------------------------------------------------------------------------------------------------------------------  
//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------

  const header2 = document.createElement("tr");
    header2.innerHTML = `<th colspan="6" style="text-align: center; background-color: #cccccc;">OTROS GASTOS</th>`;
      tabla.appendChild(header2);

  //  Mantener datos de totales actualizados   

  function obtenerOtrosGastos() {
  const totalValorest1 = parseFloat(document.getElementById("total-valoresMaqt1").textContent.replace("$", "")) || 0;
  const primerValor = parseFloat(document.getElementById("valor-0")?.textContent.replace("$", "")) || 0;
  const totalMat = parseFloat(document.getElementById("total-valores-t2").textContent.replace("$", "")) || 0;
  const inputMiscelaneos = parseFloat(document.getElementById("otros-gasto-input-0")?.value) || 0;
  const inputSeguro=parseFloat(document.getElementById("otros-gasto-input-2")?.value) || 0;

  const obligaciones = Number((totalValorest1 - primerValor)* 0.2);
  
  const terreno = 75.00;
  const admin = Number((totalValorest1 * 0.1).toFixed(2));

  //Cálculo del interés (0.09 aplicado al total base)

  const base = (totalValorest1 + totalMat + obligaciones + inputSeguro + terreno + inputMiscelaneos + admin);
  const intereses = Number((base * 0.09));

  return [
    ["Gastos Miscelaneos", -1],
    ["Gastos administrativos<sup>1</sup>", admin],
    ["Seguro Agrícola",-1],
    ["Obligaciones Patronales<sup>2</sup>", obligaciones],
    ["Uso del Terreno", terreno],

    ["Uso de capital<sup>3</sup>", intereses]
  ];
}

  const otros_gastos = obtenerOtrosGastos();


  function updateOtrosGastos() {
    const nuevosGastos = obtenerOtrosGastos();
  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;

  let totalFincaOtros = 0;

  nuevosGastos.forEach(([nombre, valor], index) => {
    const celda = document.getElementById(`otros-gasto-${index}`);
    let finalValor = valor;

    if (valor === -1) {
      const input = document.getElementById(`otros-gasto-input-${index}`);
      finalValor = parseFloat(input?.value) || 0;

      if (celda) {
        celda.textContent = "$" + finalValor.toFixed(2);
      }
    } else {
      if (celda) {
        celda.textContent = "$" + valor.toFixed(2);
      }
    }

    const fincaCell = document.getElementById(`mi-finca-otros-${index}`);
    if (fincaCell) {
      const fincaValor = finalValor * numCuerdas;
      fincaCell.textContent = "$" + fincaValor.toFixed(2);
      totalFincaOtros += fincaValor;
    }
  });

  calcularTotaldeTodo(); 
  calcularTotalOtrosGastos();

}

  
otros_gastos.forEach(([nombre, valor], index) => {
  const fila = document.createElement("tr");
  const esEditable = valor === -1;
  console.log("Agregando fila:", nombre, valor);

  fila.innerHTML = `
    <td>${nombre}</td>
    <td>N/A</td>
    <td>N/A</td>
    <td>N/A</td>
    <td>
      ${esEditable 
        ? `<input type="number" min="0" step="1" id="otros-gasto-input-${index}" value="0">` 
        : `<span id="otros-gasto-${index}">$${valor.toFixed(2)}</span>`
      }
    </td>
    <td id="mi-finca-otros-${index}">$-</td>
  `;

  

  tabla.appendChild(fila);
  if (esEditable) {
    // Escuchar cambios en el input editable
    const input = fila.querySelector(`#otros-gasto-input-${index}`);
    input.addEventListener("input", () => {
    calcularTotalOtrosGastos();
    calcularTotaldeTodo();
    updateOtrosGastos(); 

  const totalMaqt1 = parseFloat(document.getElementById("total-valoresMaqt1").textContent.replace("$", "")) || 0;
  const totalMat = parseFloat(document.getElementById("total-valores-t2").textContent.replace("$", "")) || 0;
  const inputMiscelaneos = parseFloat(document.getElementById("otros-gasto-input-4")?.value) || 0;

  });
  }
});

function calcularTotalOtrosGastos() {
    const nuevosGastos = obtenerOtrosGastos();
    let total = 0;

    for(i=3;i<6;i++){
      const elemento = document.getElementById(`otros-gasto-${i}`);
    const valor = parseFloat(elemento?.textContent.replace("$", "")) || 0;
    total += valor;0;

    };

    const totalCelda = document.getElementById("total-otros-gastos");
    if (totalCelda) {
      totalCelda.textContent = "$" + total.toFixed(2);
    }

    const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
    const fincaOtrosCell = document.getElementById("total-finca-otros");
    if (fincaOtrosCell) {
        fincaOtrosCell.textContent = "$" + (total * numCuerdas).toFixed(2);
}
}

function calcularTotaldeTodo() {
  const totalManoObra = parseFloat(document.getElementById("total-valoresMaqt1")?.textContent.replace("$", "")) || 0;
  const totalMateriales = parseFloat(document.getElementById("total-valores-t2")?.textContent.replace("$", "")) || 0;
  const subtotalOtros = parseFloat(document.getElementById("total-otros-gastos")?.textContent.replace("$", "")) || 0;

  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
  const precioUnidadUsuario = parseFloat(document.getElementById("ingreso-input-0")?.value) || 0;

  const total = totalManoObra + totalMateriales + subtotalOtros;
  const totalFinca = total * numCuerdas;

  const totalGastosElement = document.getElementById("total-todos-gastos");
  if (totalGastosElement) {
    totalGastosElement.textContent = "$" + total.toFixed(2);
  }

  const totalFincaGastosCell = document.getElementById("total-finca-todos");
  if (totalFincaGastosCell) {
    totalFincaGastosCell.textContent = "$" + totalFinca.toFixed(2);
  }

  const gastoExtra = document.getElementById("gasto-total-extra");
  if (gastoExtra) gastoExtra.textContent = "$" + total.toFixed(2);

  const gastoFinca = document.getElementById("gasto-total-extra-finca");
  if (gastoFinca) gastoFinca.textContent = "$" + totalFinca.toFixed(2);

  const precioMinimoCaja = document.getElementById("precio-minimo-caja");
  if (precioMinimoCaja) {
    precioMinimoCaja.textContent = "$" + (total / 125).toFixed(2);
  }

  const produccionMinima = document.getElementById("produccion-minima");
  if (produccionMinima) {
    console.log("Total gastos:", total);
  console.log("Precio unidad (usuario):", precioUnidadUsuario); 
  if (precioUnidadUsuario > 0) {
    produccionMinima.textContent = (total / precioUnidadUsuario).toFixed(2);
  } else {
    produccionMinima.textContent = "0";
  }
}

  const produccionMinimaStr = document.getElementById("produccion-minima")?.textContent.replace("$", "") || "0";
  const produccionMinimaNum = parseFloat(produccionMinimaStr) || 0;

  const produccionTotal = produccionMinimaNum * numCuerdas;
  const celdaProduccionTotal = document.getElementById("produccion-minima-total");
  if (celdaProduccionTotal) {
    celdaProduccionTotal.textContent = `${produccionTotal.toFixed(2)}`;
  }
}

const filaTotalOtros = document.createElement("tr");
filaTotalOtros.innerHTML = `
  <th colspan="4"> SUBTOTAL</th>
  <th colspan="1" id="total-otros-gastos">$0.00</th>
  <th id="total-finca-otros">$0.00</th>

`;
tabla.appendChild(filaTotalOtros);

const filatotalTODO=document.createElement("tr");
filatotalTODO.innerHTML=`
  <th colspan="4">TOTAL DE GASTOS</th>
  <th colspan="1" id="total-todos-gastos">$0.00</th>
  <th id="total-finca-todos">$0.00</th>
`;
tabla.appendChild(filatotalTODO);


  

    const filaVacía_3 = document.createElement("tr");
      filaVacía_3.innerHTML = `<td colspan="6" style="height: 20px; background-color: transparent;"></td>`;
      tabla.appendChild(filaVacía_3);


      


//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------------------------------- 

  const header3 = document.createElement("tr");
    header3.innerHTML = `<th colspan="6" style="text-align: center; background-color: #cccccc;">INGRESOS ESPERADOS</th>`;
      tabla.appendChild(header3);

      const ingresosEsperados = [
        ["Venta de producto","Quintal",125],
        ["Venta de semilla","Quintal",30]
    
  ];
  console.log(ingresosEsperados)

  ingresosEsperados.forEach((trabajo, index) => {
      const fila = document.createElement("tr");

    fila.innerHTML = `
        <td>${trabajo[0]}</td>
        <td>${trabajo[1]}</td>
        <td>${trabajo[2]}</td>
        <td> <input type="number" min="0" step="1" id="ingreso-input-${index}" value="0" oninput="calcularTotalIngresos(); calcularTotaldeTodo();"></td>
        <td id="ingreso-output-${index}">$0.00</td>
        <td id="mi-finca-ingreso-${index}">$0.00</td>
       `;

    tabla.appendChild(fila);
  
});

  const filas_total_ingresos=document.createElement("tr");
  filas_total_ingresos.innerHTML=`
  <th colspan="4">INGRESO BRUTO</th>
  <th colspan="1" id="total-ingresos">$0.00</th>
  <th colspan="1" id="total-finca-ingresos">$0.00</th>

  `;
  tabla.appendChild(filas_total_ingresos);

  const filas_ingreso_neto=document.createElement("tr");
  filas_ingreso_neto.innerHTML=`
  <th colspan="4">INGRESOS NETO</th>
  <th id="ingreso-neto">$0.00</th>
  <th id="ingreso-neto-finca">$0.00</th>`
    ;
  tabla.appendChild(filas_ingreso_neto);

  function calcularTotalIngresos() {
  let total = 0;
  let totalFinca = 0;
  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;

  ingresosEsperados.forEach(([_, unidad, precio], index) => {
    const input = document.getElementById(`ingreso-input-${index}`);
    const output = document.getElementById(`ingreso-output-${index}`);
    const fincaCell = document.getElementById(`mi-finca-ingreso-${index}`);
    const cantidad = parseFloat(input?.value) || 0;
    const ingreso = cantidad * precio;
    const ingresoFinca = ingreso * numCuerdas;

    if (output) {
      output.textContent = `$${ingreso.toFixed(2)}`;
    }
    if (fincaCell) {
      fincaCell.textContent = `$${ingresoFinca.toFixed(2)}`;
    }

    total += ingreso;
    totalFinca += ingresoFinca;
  });

  document.getElementById("total-ingresos").textContent = `$${total.toFixed(2)}`;
  document.getElementById("total-finca-ingresos").textContent = `$${totalFinca.toFixed(2)}`;

  const extra = document.getElementById("ingreso-total-extra");
  if (extra) extra.textContent = `$${total.toFixed(2)}`;

  const fincaExtra = document.getElementById("ingreso-total-extra-finca");
  if (fincaExtra) fincaExtra.textContent = `$${totalFinca.toFixed(2)}`;

  calcularIngresoNeto();
}

function calcularIngresoNeto() {
  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
  const totalGastos = parseFloat(document.getElementById("total-todos-gastos").textContent.replace("$", "")) || 0;
  const totalIngresos = parseFloat(document.getElementById("total-ingresos").textContent.replace("$", "")) || 0;

  const neto = totalIngresos - totalGastos;
  document.getElementById("ingreso-neto").textContent = `$${neto.toFixed(2)}`;

  const netoExtra = document.getElementById("ingreso-neto-extra");
  if (netoExtra) {
    netoExtra.textContent = `$${neto.toFixed(2)}`;
}
const fincaNeto = document.getElementById("ingreso-neto-extra-finca");

if (fincaNeto) fincaNeto.textContent = `$${(neto * numCuerdas).toFixed(2)}`;
 
  const netoFinca = neto * numCuerdas;
  const netoFincaCell = document.getElementById("ingreso-neto-finca");

  if (netoFincaCell) {
    netoFincaCell.textContent = `$${netoFinca.toFixed(2)}`;
  }
}
  
    const filaVacía_4 = document.createElement("tr");
      filaVacía_4.innerHTML = `<td colspan="6" style="height: 20px; background-color: transparent;"></td>`;
      tabla.appendChild(filaVacía_4);

    const filaCajaName=document.createElement("tr");
    filaCajaName.innerHTML=`<th colspan="5"> Producción mínima producto </th>
        <th id="produccion-minima">0</th>`
    tabla.appendChild(filaCajaName);

    const filaMinPrecioCaja=document.createElement("tr");
    filaMinPrecioCaja.innerHTML=`<th colspan="5"> Precio mínima producto </th>
    <th id="precio-minimo-caja">$0.00</th>
    `
    tabla.appendChild(filaMinPrecioCaja);


    const filaVacía_9 = document.createElement("tr");
    filaVacía_9.innerHTML = `<td colspan="6" style="height: 20px; background-color: transparent;"></td>`;
    tabla.appendChild(filaVacía_9);


//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------------------------------- 




  const ingresoTotal=document.createElement("tr");
  ingresoTotal.innerHTML=
  `<th colspan="4"> Ingreso Total </th>
  <th id="ingreso-total-extra">$0.00</th>

  <th id="ingreso-total-extra-finca">$0.00</th>
  `
  tabla.appendChild(ingresoTotal)


  const gastoTotal=document.createElement("tr");
  gastoTotal.innerHTML=`<th colspan="4"> Gasto Total </th>
  <th id="gasto-total-extra">$0.00</th>
  <th id="gasto-total-extra-finca">$0.00</th>`
  tabla.appendChild(gastoTotal);


  const ingresoNeto=document.createElement("tr");
  ingresoNeto.innerHTML=`<th colspan="4"> Ingreso Neto </th>
  <th id="ingreso-neto-extra">$0.00</th>
  <th id="ingreso-neto-extra-finca">$0.00</th>`
  tabla.appendChild(ingresoNeto);

const filaProduccionMinimaTotal = document.createElement("tr");
filaProduccionMinimaTotal.innerHTML = `
  <th colspan="4">PRODUCCIÓN MÍNIMA TOTAL DE CAJAS DE GUINEO</th>
  <th id="produccion-minima-total-finca">-</th>
  <th id="produccion-minima-total">0</th>

`;
tabla.appendChild(filaProduccionMinimaTotal);


//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------------------------------- 

const proyeccionBody = document.getElementById("proyeccion-tbody");

proyeccionBody.innerHTML = `
  <tr>
    <td colspan="5">Número de Plantas por Cuerda para una distancia de 1.3 pies</td>
    <td><input type="number" min="0" step="1" id="plantas-por-cuerda"></td>
  </tr>
  <tr>
    <td colspan="5">Número de Cuerdas</td>
    <td><input type="number" min="0" step="1" id="numero-cuerdas"></td>
    </tr>
  <tr>
    <td colspan="5">Rendimiento por Planta (el promedio es de 4 lbs por planta)</td>
    <td><input type="number" min="0" step="1" id="rendimiento-planta"></td>
  </tr>
  <tr>
    <td colspan="5">Rendimiento por Cuerda (Quintal)</td>
    <td id="rendimiento-cuerda">0</td>

`;

function calcularRendimientoPorCuerda() {
  const plantasPorCuerda = parseFloat(document.getElementById("plantas-por-cuerda")?.value) || 0;
  const rendimientoPlanta = parseFloat(document.getElementById("rendimiento-planta")?.value) || 0;
  const rendimientoCuerda = (plantasPorCuerda * rendimientoPlanta) / 100;

  const celda = document.getElementById("rendimiento-cuerda");
  if (celda) {
    celda.textContent = rendimientoCuerda.toFixed(2);
  }
}


const nuevoInputCuerdas = document.getElementById("numero-cuerdas");
const inputPlantas = document.getElementById("plantas-por-cuerda");
const inputRendimiento = document.getElementById("rendimiento-planta");

if (nuevoInputCuerdas) {
  nuevoInputCuerdas.addEventListener("input", () => {
    calcularTotaldeTodo();
    actualizarValoresMiFinca_t1();
    calcularTotal_año_t2();
    updateOtrosGastos();
    calcularTotalIngresos();
  });
}

if (inputPlantas) {
  inputPlantas.addEventListener("input", calcularRendimientoPorCuerda);
}
if (inputRendimiento) {
  inputRendimiento.addEventListener("input", calcularRendimientoPorCuerda);
}
 

  </script>
</body>
</html>
