<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Presupuesto modelo: 칌ame habanero en la zona de altura h칰meda en PR (1 cuerda)</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    input, select { width: 95%; padding: 4px; }

    td:first-child,
    th:first-child{
      text-align: left;
    }
  </style>
</head>
<body>
  <div id="botones-acciones" style="text-align: center; margin-top: 40px;">
    <button id="btn-excel">游닌 Descargar Excel</button>
    <button id="btn-pdf">游늯 Guardar PDF</button>
    <button id="btn-email">九괦잺 Enviar por Email</button>
    <button onclick="window.print()">游둳 Imprimir</button>
  </div>
  


  <!-- Excel export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  <!-- PDF export -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.9.3/html2pdf.bundle.min.js"></script>

  <script>
      // Descargar Excel
      document.getElementById("btn-excel").addEventListener("click", function () {
        const table = document.querySelector("table"); 
        const wb = XLSX.utils.table_to_book(table, { sheet: "Presupuesto" });
        XLSX.writeFile(wb, "presupuesto.xlsx");
      });
    
      // Guardar PDF
      document.getElementById("btn-pdf").addEventListener("click", function () {
        const content = document.body; 
        html2pdf().from(content).set({
          margin: 0.5,
          filename: "presupuesto.pdf",
          html2canvas: { scale: 2 },
          jsPDF: { unit: "in", format: "letter", orientation: "portrait" }
        }).save();
      });
    
      // Enviar por Email
      document.getElementById("btn-email").addEventListener("click", function () {
        const asunto = "Presupuesto Modelo";
        const cuerpo = "Saludos,\n\nAdjunto encontrar치 el presupuesto modelo generado.\n\nGracias.";
        window.location.href = `mailto:?subject=${encodeURIComponent(asunto)}&body=${encodeURIComponent(cuerpo)}`;
      });
    </script>
  
  <h1>Presupuesto modelo: 칌ame habanero en la zona de altura h칰meda en PR (1 cuerda)<sup style="font-size: 0.1em;">K11</sup></h1>

  

  <table>
    <thead>
    
    

    </thead>
    <tbody id="tabla">
      <!-- Filas generadas por JS -->
    </tbody>

    <tfoot>
      <tr>
        <td colspan="10" style="padding: 20px; background-color: #fff; line-height: 1.6;">

          <h2 style="color: #000000; font-size: 1.1em">Supuestos</h2>			
          <ol style="padding-left: 20px;">
            <li>10% del total de mano de obra y maquinaria</li>
            <li>Las obligaciones patronales incluyen pagos al Internal Revenue Service (Seguro Social), Fondo del Seguro del Estado (Seguro Obrero), Departamento del Trabajo (Seguro por Desempleo) y Seguro Social Choferil (Seguro Choferil).</li>
            <li>El uso de capital circulante es el costo del dinero en efectivo que se usa en la empresa.  Total de gastos en efectivo por la tasa de inter칠s prevaleciente en el mercado (9%).</li>

								
          </ol>

          <span style="font-weight: bold;font-size: 1.1em;">Preparado por:</span><br><br>
          <strong>  Mildred Cortes, PhD</strong><br>
          Catedr치tica de Extensi칩n Agr칤cola en Econom칤a Agr칤cola<br>
          <strong>Manuel Diaz, PhD</strong><br>
          Especialista en Farin치ceos<br><br>
      

          <span style="font-weight: bold;font-size: 1.1em;">Versi칩n Electr칩nica:</span><br><br> 
          <strong> Alexandra Gregory Crespo, PhD</strong><br>
          Catedr치tica del Servicio de Extensi칩n Agr칤cola en Econom칤a Agr칤cola<br>
          <strong>Joe Kirk R. Lucarne</strong> <br>
          Estudiante Graduado Servicio de Extensi칩n Agr칤cola<br>
          <strong>Yaira A. Avil칠s Ortiz</strong>
          <br>
          <br>

    
          <span style="font-weight: bold; font-size:1.1em;">Versi칩n Web:</span><br><br>
         <strong> Julio C. Hern치ndez Correa</strong><br>
          Catedr치tico del Servicio de Extensi칩n Agr칤cola en Econom칤a Agr칤cola<br><br><br>
    
          <span style="font-weight: bold;">Fecha de revisi칩n:</span><br>
          Junio 2025<br><br>
    
          <div style="margin-top: 20px; padding: 12px; border-left: 5px solid #d9534f; background-color: #fdf2f2;">
            <strong>AVISO:</strong> Los Presupuestos Modelos presentan la informaci칩n de los ingresos y gastos bajo condiciones normales y caracter칤sticas particulares de una finca. La Universidad de Puerto Rico no asume responsabilidad por los resultados si los ingresos y gastos de una empresa en particular difieren de dicha publicaci칩n. El usuario de estos modelos releva a la Universidad de Puerto Rico de toda responsabilidad, reclamaci칩n, p칠rdida, da침o o costo relacionado o surgido por el uso de estos modelos.
          </div>
    
          <div style="margin-top: 20px; font-size: 0.85em; text-align: center; color: #999;">
            This material is based upon work supported by USDA/OPPE under Award Number: AO212501x443G010
          </div>
        </td>
      </tr>
    </tfoot>

    
  </table>
<!----------------------------------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------------------------------->
  <script>

    const tabla = document.getElementById("tabla");
    const produccion_cuerda = document.createElement("tr");
    produccion_cuerda.innerHTML = `
      <th colspan="6" style="text-align: center; background-color: #cccccc;">
        PROYECCI칍N POR CUERDA
      </th>
    `;
    tabla.appendChild(produccion_cuerda);

    const fila1 = document.createElement("tr");
    fila1.innerHTML=`<tr>
    <td colspan="5">N칰mero de Plantas por Cuerda para una distancia de 1.3 pies</td>
    <td><input type="number" min="0" step="1" id="plantas-por-cuerda"></td>
  </tr>`;
  tabla.appendChild(fila1);

  const fila2 = document.createElement("tr");
    fila2.innerHTML=`<tr>
    <td colspan="5">N칰mero de Cuerdas</td>
    <td><input type="number" min="0" step="1" id="numero-cuerdas"></td>
    </tr>
  <tr>`;
    tabla.appendChild(fila2)

    const fila3 = document.createElement("tr");
    fila3.innerHTML=`<tr><td colspan="5">Rendimiento por Planta (el promedio es de 4 lbs por planta)</td>
    <td><input type="number" min="0" step="1" id="rendimiento-planta"></td>
  </tr>`;
  tabla.appendChild(fila3);

    const fila4=document.createElement("tr");
    fila4.innerHTML= `<tr>
    <td colspan="5">Rendimiento por Cuerda (Quintal)</td>
    <td id="rendimiento-cuerda">0</td>`;

    tabla.appendChild(fila4);

    const filaVac칤a_10 = document.createElement("tr");
    filaVac칤a_10.innerHTML = `<td colspan="6" style="height: 20px; background-color: transparent;"></td>`;
    tabla.appendChild(filaVac칤a_10);


    const columnas_titulos = document.createElement("tr");
    columnas_titulos.innerHTML = `
      <th>Partida</th>
      <th>Unidad</th>
      <th>Cantidad</th>
      <th>Precio/Unidad</th>
      <th>Valor</th>
      <th>Mi Finca</th>
    `;
    tabla.appendChild(columnas_titulos);

    const header1 = document.createElement("tr");
      header1.innerHTML = `<th colspan="6" style="text-align: center; background-color: #cccccc;">GASTOS EN MANO DE OBRA</th>`;
      tabla.appendChild(header1);

    const mano_de_obra_1 = [
    "Preparaci칩n del suelo", 
    "Encalado", 
    "Preparaci칩n de bancos",
    "Preparaci칩n de semilla",
    "Distribuci칩n y siembra de semilla ",
    "Estaqueado",
    "Abonamiento",
    "Cultivo y combate de plagas",
    "Cosecho y manejo de productos",
  ];

  

    mano_de_obra_1.forEach((trabajo, index) => {
      const fila = document.createElement("tr");
      
      fila.innerHTML = `
      <td>${trabajo}</td>
      <td>Horas</td>
      <td><input type="number" min="0" step="1" id="cantidad-${index}"  oninput="calcularValor_t1(${index})"></td>
      <td><input type="number" min="0" step="0.01" id="costo-${index}"  oninput="calcularValor_t1(${index})"></td>
      <td id="valor-${index}">$0.00</td>
      <td id="mi-finca-t1-${index}">$-</td>
    `;

    tabla.appendChild(fila);
  });



    const filaTotalMaq_t1 = document.createElement("tr");
    filaTotalMaq_t1.innerHTML = `
        <th colspan="4">TOTAL DE GASTOS DE MANO DE OBRA Y MAQUINARIA</th>
        <th id="total-valoresMaqt1">$0.00</th>
        <th id=total-finca-Maqt1>$0.00</th>    
      `;
      tabla.appendChild(filaTotalMaq_t1);


    function calcularValor_t1(index){
      const costo = parseFloat(document.getElementById(`costo-${index}`).value) || 0;
      const cantidad= parseFloat(document.getElementById(`cantidad-${index}`).value) || 0;
      const valorCalculado=costo * cantidad;
      document.getElementById(`valor-${index}`).textContent = "$" + valorCalculado.toFixed(2);

      const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
    const miFincaValor = valorCalculado * numCuerdas;
    const miFincaCell = document.getElementById(`mi-finca-t1-${index}`);
    if (miFincaCell) {
      miFincaCell.textContent = "$" + miFincaValor.toFixed(2);
    }

    calcularTotal_a침o_t1(); 
    calcularTotaldeTodo(); 
    }


    function calcularTotal_a침o_t1() {
    let total_valores_t1 = 0;
    let total_con_maquinaria_t1=0;
    let totalFinca_valores_t1 = 0;
    let totalFinca_con_maquinaria_t1 = 0;

  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;


    for (let i = 0; i < mano_de_obra_1.length; i++) {
    const texto = document.getElementById(`valor-${i}`).textContent; 
    const valor = parseFloat(texto.replace("$", "")) || 0;
    const finca = valor * numCuerdas;
    if (i<2){
      total_con_maquinaria_t1+=valor;
      totalFinca_con_maquinaria_t1 += finca;
    }
    else{
    total_valores_t1 += valor;
    totalFinca_valores_t1 += finca;
    }
  }

  const totalGeneral = total_valores_t1 + total_con_maquinaria_t1;
  const totalFincaGeneral = totalFinca_valores_t1 + totalFinca_con_maquinaria_t1;

  document.getElementById("total-valoresMaqt1").textContent = "$" + totalGeneral.toFixed(2);
  document.getElementById("total-finca-Maqt1").textContent = "$" + totalFincaGeneral.toFixed(2);

  updateOtrosGastos();
}

function actualizarValoresMiFinca_t1() {
  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;

  for (let i = 0; i < mano_de_obra_1.length; i++) {
    const cantidad = parseFloat(document.getElementById(`cantidad-${i}`)?.value) || 0;
    const costo = parseFloat(document.getElementById(`costo-${i}`)?.value) || 0;
    const valor = cantidad * costo;
    const miFincaCell = document.getElementById(`mi-finca-t1-${i}`);
    if (miFincaCell) {
      miFincaCell.textContent = "$" + (valor * numCuerdas).toFixed(2);
    }
  }

  calcularTotal_a침o_t1(); 
}

    const filaVac칤a_1 = document.createElement("tr");
    filaVac칤a_1.innerHTML = `<td colspan=6 style="height: 20px; background-color: transparent;"></td>`;
      tabla.appendChild(filaVac칤a_1);

//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------

    const materiales_t2 = [
    ["Semilla","Quintal"],
    ["Carbonato calizo","Tonelada"],
    ["Estacas","C/U"],
    ["Abono (12-5-15-3%EM)", "Quintal"],
    ["Fungicida","Onza"],
    ["Herbicida (preemergente)", "Pinta"],
    ["Herbicida (postemergente)","Gal칩n"],
    ["Nematicidas/insecticidas",'Litro'],
    ["Cajas","C/U"]

  ]

      const header_t2 = document.createElement("tr");
       header_t2.innerHTML = `<th colspan="6" style="text-align: center; background-color: #cccccc;">GASTOS EN MATERIALES</th>`;
       tabla.appendChild(header_t2);

       materiales_t2.forEach((trabajo, index) => {
      const fila = document.createElement("tr");
      
      fila.innerHTML = `
      <td>${trabajo[0]}</td>
      <td>${trabajo[1]}</td>

      <td><input type="number" min="0" step="1" id="t2-cantidad-${index}" oninput="calcularValor_t2(${index})"></td>
      <td><input type="number" min="0" step="1" id="t2-costo-${index}" oninput=calcularValor_t2(${index})></td>
      <td id="t2-valor-${index}">$0.00</td>
      <td id="mi-finca-t2-${index}">-</td>
     
    `;

    tabla.appendChild(fila);
  });
 


  const filaTotal_t2 = document.createElement("tr");
    filaTotal_t2.innerHTML = `
        <th colspan="4">SUBTOTAL</th>
        <th id="total-valores-t2">$0.00</th>
        <th id=total-finca-t2>$.00</th>

        
      `;
      tabla.appendChild(filaTotal_t2);

    function calcularValor_t2(index){
    const costo = parseFloat(document.getElementById(`t2-costo-${index}`).value) || 0;
      const cantidad= parseFloat(document.getElementById(`t2-cantidad-${index}`).value) || 0;
      const valorCalculado=costo * cantidad;
      document.getElementById(`t2-valor-${index}`).textContent = "$" + valorCalculado.toFixed(2);

    const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
    const miFincaValor = valorCalculado * numCuerdas;
    const miFincaCell = document.getElementById(`mi-finca-t2-${index}`);
    if (miFincaCell) {
      miFincaCell.textContent = "$" + miFincaValor.toFixed(2);
    }
    calcularTotal_a침o_t2();
    }

    function calcularMiFinca_t2(index){
        const valor=parseFloat(document.getElementById(`t2-valor-${index}`).textContent) || 0;
    }

    function calcularTotal_a침o_t2() {
      let total_valores_t2 = 0;
      let total_finca_t2 = 0;
    const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
    for (let i = 0; i < materiales_t2.length; i++) {
      const texto = document.getElementById(`t2-valor-${i}`).textContent || "$0.00";
    const valor = parseFloat(texto.replace("$", "")) || 0;  
      total_valores_t2 += valor;

      const miFincaValor = valor * numCuerdas;
      total_finca_t2 += miFincaValor;
    const celda = document.getElementById(`mi-finca-t2-${i}`);
    if (celda) {
      celda.textContent = "$" + miFincaValor.toFixed(2);
  }


}
document.getElementById("total-valores-t2").textContent = "$" + total_valores_t2.toFixed(2);
  document.getElementById("total-finca-t2").textContent = "$" + total_finca_t2.toFixed(2);
  calcularTotaldeTodo();
}
 

    const filaVac칤a_2 = document.createElement("tr");
      filaVac칤a_2.innerHTML = `<td colspan="6" style="height: 20px; background-color: transparent;"></td>`;
      tabla.appendChild(filaVac칤a_2);

//-----------------------------------------------------------------------------------------------------------------------------------------------------  
//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------

  const header2 = document.createElement("tr");
    header2.innerHTML = `<th colspan="6" style="text-align: center; background-color: #cccccc;">OTROS GASTOS</th>`;
      tabla.appendChild(header2);

  //  Mantener datos de totales actualizados   

  function obtenerOtrosGastos() {
  const totalValorest1 = parseFloat(document.getElementById("total-valoresMaqt1").textContent.replace("$", "")) || 0;
  const primerValor = parseFloat(document.getElementById("valor-0")?.textContent.replace("$", "")) || 0;
  const totalMat = parseFloat(document.getElementById("total-valores-t2").textContent.replace("$", "")) || 0;
  const inputMiscelaneos = parseFloat(document.getElementById("otros-gasto-input-0")?.value) || 0;
  const inputSeguro=parseFloat(document.getElementById("otros-gasto-input-2")?.value) || 0;

  const obligaciones = Number((totalValorest1 - primerValor)* 0.2);
  
  const terreno = 75.00;
  const admin = Number((totalValorest1 * 0.1).toFixed(2));

  //C치lculo del inter칠s (0.09 aplicado al total base)

  const base = (totalValorest1 + totalMat + obligaciones + inputSeguro + terreno + inputMiscelaneos + admin);
  const intereses = Number((base * 0.09));

  return [
    ["Gastos Miscelaneos", -1],
    ["Gastos administrativos<sup>1</sup>", admin],
    ["Seguro Agr칤cola",-1],
    ["Obligaciones Patronales<sup>2</sup>", obligaciones],
    ["Uso del Terreno", terreno],

    ["Uso de capital<sup>3</sup>", intereses]
  ];
}

  const otros_gastos = obtenerOtrosGastos();


  function updateOtrosGastos() {
    const nuevosGastos = obtenerOtrosGastos();
  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;

  let totalFincaOtros = 0;

  nuevosGastos.forEach(([nombre, valor], index) => {
    const celda = document.getElementById(`otros-gasto-${index}`);
    let finalValor = valor;

    if (valor === -1) {
      const input = document.getElementById(`otros-gasto-input-${index}`);
      finalValor = parseFloat(input?.value) || 0;

      if (celda) {
        celda.textContent = "$" + finalValor.toFixed(2);
      }
    } else {
      if (celda) {
        celda.textContent = "$" + valor.toFixed(2);
      }
    }

    const fincaCell = document.getElementById(`mi-finca-otros-${index}`);
    if (fincaCell) {
      const fincaValor = finalValor * numCuerdas;
      fincaCell.textContent = "$" + fincaValor.toFixed(2);
      totalFincaOtros += fincaValor;
    }
  });

  calcularTotaldeTodo(); 
  calcularTotalOtrosGastos();

}

  
otros_gastos.forEach(([nombre, valor], index) => {
  const fila = document.createElement("tr");
  const esEditable = valor === -1;
  console.log("Agregando fila:", nombre, valor);

  fila.innerHTML = `
    <td>${nombre}</td>
    <td>N/A</td>
    <td>N/A</td>
    <td>N/A</td>
    <td>
      ${esEditable 
        ? `<input type="number" min="0" step="1" id="otros-gasto-input-${index}" value="0">` 
        : `<span id="otros-gasto-${index}">$${valor.toFixed(2)}</span>`
      }
    </td>
    <td id="mi-finca-otros-${index}">$-</td>
  `;

  

  tabla.appendChild(fila);
  if (esEditable) {

    const input = fila.querySelector(`#otros-gasto-input-${index}`);
    input.addEventListener("input", () => {
    calcularTotalOtrosGastos();
    calcularTotaldeTodo();
    updateOtrosGastos(); 

  const totalMaqt1 = parseFloat(document.getElementById("total-valoresMaqt1").textContent.replace("$", "")) || 0;
  const totalMat = parseFloat(document.getElementById("total-valores-t2").textContent.replace("$", "")) || 0;
  const inputMiscelaneos = parseFloat(document.getElementById("otros-gasto-input-4")?.value) || 0;

  });
  }
});

function calcularTotalOtrosGastos() {
    const nuevosGastos = obtenerOtrosGastos();
    let total = 0;

    for(i=3;i<6;i++){
      const elemento = document.getElementById(`otros-gasto-${i}`);
    const valor = parseFloat(elemento?.textContent.replace("$", "")) || 0;
    total += valor;0;

    };

    const totalCelda = document.getElementById("total-otros-gastos");
    if (totalCelda) {
      totalCelda.textContent = "$" + total.toFixed(2);
    }

    const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
    const fincaOtrosCell = document.getElementById("total-finca-otros");
    if (fincaOtrosCell) {
        fincaOtrosCell.textContent = "$" + (total * numCuerdas).toFixed(2);
}
}

function calcularTotaldeTodo() {
  const totalManoObra = parseFloat(document.getElementById("total-valoresMaqt1")?.textContent.replace("$", "")) || 0;
  const totalMateriales = parseFloat(document.getElementById("total-valores-t2")?.textContent.replace("$", "")) || 0;
  const subtotalOtros = parseFloat(document.getElementById("total-otros-gastos")?.textContent.replace("$", "")) || 0;

  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
  const precioUnidadUsuario = parseFloat(document.getElementById("ingreso-input-0")?.value) || 0;

  const total = totalManoObra + totalMateriales + subtotalOtros;
  const totalFinca = total * numCuerdas;

  const totalGastosElement = document.getElementById("total-todos-gastos");
  if (totalGastosElement) {
    totalGastosElement.textContent = "$" + total.toFixed(2);
  }

  const totalFincaGastosCell = document.getElementById("total-finca-todos");
  if (totalFincaGastosCell) {
    totalFincaGastosCell.textContent = "$" + totalFinca.toFixed(2);
  }

  const gastoExtra = document.getElementById("gasto-total-extra");
  if (gastoExtra) gastoExtra.textContent = "$" + total.toFixed(2);

  const gastoFinca = document.getElementById("gasto-total-extra-finca");
  if (gastoFinca) gastoFinca.textContent = "$" + totalFinca.toFixed(2);

  const precioMinimoCaja = document.getElementById("precio-minimo-caja");
  if (precioMinimoCaja) {
    precioMinimoCaja.textContent = "$" + (total / 125).toFixed(2);
  }

  const produccionMinima = document.getElementById("produccion-minima");
  if (produccionMinima) {
    console.log("Total gastos:", total);
  console.log("Precio unidad (usuario):", precioUnidadUsuario); 
  if (precioUnidadUsuario > 0) {
    produccionMinima.textContent = (total / precioUnidadUsuario).toFixed(2);
  } else {
    produccionMinima.textContent = "0";
  }
}

  const produccionMinimaStr = document.getElementById("produccion-minima")?.textContent.replace("$", "") || "0";
  const produccionMinimaNum = parseFloat(produccionMinimaStr) || 0;

  const produccionTotal = produccionMinimaNum * numCuerdas;
  const celdaProduccionTotal = document.getElementById("produccion-minima-total");
  if (celdaProduccionTotal) {
    celdaProduccionTotal.textContent = `${produccionTotal.toFixed(2)}`;
  }
}

const filaTotalOtros = document.createElement("tr");
filaTotalOtros.innerHTML = `
  <th colspan="4"> SUBTOTAL</th>
  <th colspan="1" id="total-otros-gastos">$0.00</th>
  <th id="total-finca-otros">$0.00</th>

`;
tabla.appendChild(filaTotalOtros);

const filatotalTODO=document.createElement("tr");
filatotalTODO.innerHTML=`
  <th colspan="4">TOTAL DE GASTOS</th>
  <th colspan="1" id="total-todos-gastos">$0.00</th>
  <th id="total-finca-todos">$0.00</th>
`;
tabla.appendChild(filatotalTODO);


  

    const filaVac칤a_3 = document.createElement("tr");
      filaVac칤a_3.innerHTML = `<td colspan="6" style="height: 20px; background-color: transparent;"></td>`;
      tabla.appendChild(filaVac칤a_3);

//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------------------------------- 

  const header3 = document.createElement("tr");
    header3.innerHTML = `<th colspan="6" style="text-align: center; background-color: #cccccc;">INGRESOS ESPERADOS</th>`;
      tabla.appendChild(header3);

      const ingresosEsperados = [
        ["Venta de producto","Quintal",125],
        ["Venta de semilla","Quintal",30]
    
  ];
  console.log(ingresosEsperados)

  ingresosEsperados.forEach((trabajo, index) => {
      const fila = document.createElement("tr");

    fila.innerHTML = `
        <td>${trabajo[0]}</td>
        <td>${trabajo[1]}</td>
        <td>${trabajo[2]}</td>
        <td> <input type="number" min="0" step="1" id="ingreso-input-${index}" value="0" oninput="calcularTotalIngresos(); calcularTotaldeTodo();"></td>
        <td id="ingreso-output-${index}">$0.00</td>
        <td id="mi-finca-ingreso-${index}">$0.00</td>
       `;

    tabla.appendChild(fila);
  
});

  const filas_total_ingresos=document.createElement("tr");
  filas_total_ingresos.innerHTML=`
  <th colspan="4">INGRESO BRUTO</th>
  <th colspan="1" id="total-ingresos">$0.00</th>
  <th colspan="1" id="total-finca-ingresos">$0.00</th>

  `;
  tabla.appendChild(filas_total_ingresos);

  const filas_ingreso_neto=document.createElement("tr");
  filas_ingreso_neto.innerHTML=`
  <th colspan="4">INGRESOS NETO</th>
  <th id="ingreso-neto">$0.00</th>
  <th id="ingreso-neto-finca">$0.00</th>`
    ;
  tabla.appendChild(filas_ingreso_neto);

  function calcularTotalIngresos() {
  let total = 0;
  let totalFinca = 0;
  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;

  ingresosEsperados.forEach(([_, unidad, precio], index) => {
    const input = document.getElementById(`ingreso-input-${index}`);
    const output = document.getElementById(`ingreso-output-${index}`);
    const fincaCell = document.getElementById(`mi-finca-ingreso-${index}`);
    const cantidad = parseFloat(input?.value) || 0;
    const ingreso = cantidad * precio;
    const ingresoFinca = ingreso * numCuerdas;

    if (output) {
      output.textContent = `$${ingreso.toFixed(2)}`;
    }
    if (fincaCell) {
      fincaCell.textContent = `$${ingresoFinca.toFixed(2)}`;
    }

    total += ingreso;
    totalFinca += ingresoFinca;
  });

  document.getElementById("total-ingresos").textContent = `$${total.toFixed(2)}`;
  document.getElementById("total-finca-ingresos").textContent = `$${totalFinca.toFixed(2)}`;

  const extra = document.getElementById("ingreso-total-extra");
  if (extra) extra.textContent = `$${total.toFixed(2)}`;

  const fincaExtra = document.getElementById("ingreso-total-extra-finca");
  if (fincaExtra) fincaExtra.textContent = `$${totalFinca.toFixed(2)}`;

  calcularIngresoNeto();
}

function calcularIngresoNeto() {
  const numCuerdas = parseFloat(document.getElementById("numero-cuerdas")?.value) || 0;
  const totalGastos = parseFloat(document.getElementById("total-todos-gastos").textContent.replace("$", "")) || 0;
  const totalIngresos = parseFloat(document.getElementById("total-ingresos").textContent.replace("$", "")) || 0;

  const neto = totalIngresos - totalGastos;
  document.getElementById("ingreso-neto").textContent = `$${neto.toFixed(2)}`;

  const netoExtra = document.getElementById("ingreso-neto-extra");
  if (netoExtra) {
    netoExtra.textContent = `$${neto.toFixed(2)}`;
}
const fincaNeto = document.getElementById("ingreso-neto-extra-finca");

if (fincaNeto) fincaNeto.textContent = `$${(neto * numCuerdas).toFixed(2)}`;
 
  const netoFinca = neto * numCuerdas;
  const netoFincaCell = document.getElementById("ingreso-neto-finca");

  if (netoFincaCell) {
    netoFincaCell.textContent = `$${netoFinca.toFixed(2)}`;
  }
}
  
    const filaVac칤a_4 = document.createElement("tr");
      filaVac칤a_4.innerHTML = `<td colspan="6" style="height: 20px; background-color: transparent;"></td>`;
      tabla.appendChild(filaVac칤a_4);

    const filaCajaName=document.createElement("tr");
    filaCajaName.innerHTML=`<th colspan="5"> Producci칩n m칤nima producto </th>
        <th id="produccion-minima">0</th>`
    tabla.appendChild(filaCajaName);

    const filaMinPrecioCaja=document.createElement("tr");
    filaMinPrecioCaja.innerHTML=`<th colspan="5"> Precio m칤nima producto </th>
    <th id="precio-minimo-caja">$0.00</th>
    `
    tabla.appendChild(filaMinPrecioCaja);


    const filaVac칤a_9 = document.createElement("tr");
    filaVac칤a_9.innerHTML = `<td colspan="6" style="height: 20px; background-color: transparent;"></td>`;
    tabla.appendChild(filaVac칤a_9);


//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------------------------------- 

  const ingresoTotal=document.createElement("tr");
  ingresoTotal.innerHTML=
  `<th colspan="4"> Ingreso Total </th>
  <th id="ingreso-total-extra">$0.00</th>

  <th id="ingreso-total-extra-finca">$0.00</th>
  `
  tabla.appendChild(ingresoTotal)


  const gastoTotal=document.createElement("tr");
  gastoTotal.innerHTML=`<th colspan="4"> Gasto Total </th>
  <th id="gasto-total-extra">$0.00</th>
  <th id="gasto-total-extra-finca">$0.00</th>`
  tabla.appendChild(gastoTotal);


  const ingresoNeto=document.createElement("tr");
  ingresoNeto.innerHTML=`<th colspan="4"> Ingreso Neto </th>
  <th id="ingreso-neto-extra">$0.00</th>
  <th id="ingreso-neto-extra-finca">$0.00</th>`
  tabla.appendChild(ingresoNeto);

const filaProduccionMinimaTotal = document.createElement("tr");
filaProduccionMinimaTotal.innerHTML = `
  <th colspan="4">PRODUCCI칍N M칈NIMA DE PRODUCTO</th>
  <th id="produccion-minima-total-finca">-</th>
  <th id="produccion-minima-total">0</th>

`;
tabla.appendChild(filaProduccionMinimaTotal);


//-----------------------------------------------------------------------------------------------------------------------------------------------------
//-----------------------------------------------------------------------------------------------------------------------------------------------------
//----------------------------------------------------------------------------------------------------------------------------------------------------- 


function calcularRendimientoPorCuerda() {
  const plantasPorCuerda = parseFloat(document.getElementById("plantas-por-cuerda")?.value) || 0;
  const rendimientoPlanta = parseFloat(document.getElementById("rendimiento-planta")?.value) || 0;
  const rendimientoCuerda = (plantasPorCuerda * rendimientoPlanta) / 100;

  const celda = document.getElementById("rendimiento-cuerda");
  if (celda) {
    celda.textContent = rendimientoCuerda.toFixed(2);
  }
}


const nuevoInputCuerdas = document.getElementById("numero-cuerdas");
const inputPlantas = document.getElementById("plantas-por-cuerda");
const inputRendimiento = document.getElementById("rendimiento-planta");

if (nuevoInputCuerdas) {
  nuevoInputCuerdas.addEventListener("input", () => {
    calcularTotaldeTodo();
    actualizarValoresMiFinca_t1();
    calcularTotal_a침o_t2();
    updateOtrosGastos();
    calcularTotalIngresos();
  });
}

if (inputPlantas) {
  inputPlantas.addEventListener("input", calcularRendimientoPorCuerda);
}
if (inputRendimiento) {
  inputRendimiento.addEventListener("input", calcularRendimientoPorCuerda);
}
 

  </script>
</body>
</html>
